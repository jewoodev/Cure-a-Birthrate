# < 작업 과정 >

## 1. **데이터 수집 및 전처리 (preprocessing)**

## 2. **데이터 탐색 (EDA)**

### **1) 전국 데이터 프레임 & 광역자치단체별 데이터프레임**

### **2) 다중회귀이므로 공산성 확인**

   (1) 상관관계 분석 (전국, 행정구역별)

상관계수가 0.85 이상인 설명변수들은 모형에 포함할 한 개의 대표 변수를 선별하거나,
상관성을 줄이기 위하여 설명변수들을 변수 변환하기

     * 제외할 독립변수
       - 근린공원수 : 유의미한 상관관계가 나타나지 않음
       - 대형마트 수 : 분산도가 높고 영향도 적음
       - 학원수, 종합체육시설 : EDA 과정에서 음의 영향이 컸고 논문에서의 결과를 보니 상관계수가 음수이고 P-value 값이 약 0.5로 높음
       - 총 아파트 매매 : 집 구매 목적이 다르기 때문
       - 재정자립도 : 데이터가 적어 유의미한 결과를 나타내지 못할 것 같아 제외

     * 그외 : 남성육아휴직, GGI
       - 지금 현재 수집된 데이터로는 남성육아휴직은 증가하고 있지만 출산율 증가에 영향을 주고 있다고 보기 어려움. 
         그러나 해외 성공사례와는 다른 결과로 인해 확인하고자 독립변수에 추가

   (2) 변수 변환

     - 이혼건수 —> 이혼율로 변경 : 혼인건수 대비 이혼건수로 설정하여 진행
     - 대졸여성 2006-2007 결측치 대체 : 시대적 반영을 위해 --> 2008-2021 대졸 평균 증가율 대신 2008-2009 증가율로 2006-2007에 넣을 것
     - 영유아 1인당 보육시설 수 —> 2006 - 2007년의 결측값은 2008-2009년의 증가비율로 설정



### **3) 표본을 늘리기 위해 월별데이터로 진행**

(1) 월별데이터가 있는 독립변수 설정

* 진행할 독립변수

    고령인구비율, 출생아수, 이혼건수, 혼인건수, 예금은행예금(시장의 상황을 대변), 경제활동참가율(여성), 
    소비자물가지수(도시의 가계(가구)가 일상생활을 위해 구입하는 서비스(재화, 용역)의 평균가격을 측정한 지수),
    미분양주택현황(부동산 심리를 알 수 있는 주요 지표), 아파트 전세 가격지수, 지가변동률,

* 용어

>>미분양 : 사업계획 승인권자로부터 분양승인을 받아 일반인을 대상으로 분양을 실히아였으나 분양되지 않은 주택

>>민간부분 : 국민주택기금을 지원받지 않고 순수민간 자본으로 건설하는 주택

>>공공부문 : 국민주택기금을 지원받아 건설하는 주택

* 미진행 독립변수

    ~~남녀성비~~, ~~사망자수~~, ~~순이동인구(전입,전출인구)~~, ~~대출금액~~, ~~고용률(전체)~~,
    ~~상용직비중~~, ~~실업률~~, ~~청년고용률(분기)~~, ~~취업자수~~, ~~아파트(매매,월세,전세)가격지~~,
    ~~주택(매매,월세,전세)가격지수~~, ~~수입액,수출액~~, ~~제조업생산증감률~~, ~~창업기업수~~, 
    ~~대형소매점판매액(정부의 경제정책과 기업의 경여 계획수립에 필요한 서비스업생산지수를 파악)~~,
    ~~어음부도율(지급기한이 되었는데도 어음에 적힌 돈을 받지못하는 일이 발생하는 비율, 시중자금시장상황을 보여주는 지표)~~


(2) 특성 중요도 파악

(3) 집단화 (행정구역별)

     행정구역별로 진행 시, 지역간 출산율 비교 및 지역 차이 줄이는 모델 구현을 위해 
     행정적인 지역구분 이외에 별도로 
     각 출산력 측정 변수를 대상으로 통계적인 군집이 나타나지 않는지 확인 필요

     * 진행 방법
       - k-means clustering과 hierarchical clustering 사용 —> 가장 모형 설명력이 높은 군집 찾기 
       - 행정구역별로 유사한 경향을 나타내는 집단을 묶고 그 효과를 반영하기 위 해 집단화 (clustering) 과정 실시 
       - 이를 추후에 모형 평가 시 통계적 분류의 근거로 활용할 수 있음.

       => 효과 : 출산력의 결정모형을 만드는데 있어서 가장 최적(best fitting)의 모형 을 만들기 위한 과정

### **4) 결측값 대체**

     값이 없는 년도의 독립변수 중

     - 결측율이 지나치게 높은(30% 이상) 독립변수 : 결측값 대체 없이 원자료로 진행 (값을 0으로 두고)
     - 결측율이 낮은 독립변수 : 결측값 대체
     ⇒ 결측율 대체로 인하여 발생하는 편의(bias)를 최소화하기 위함


## 3. **여러 모델을 통해**

### 0) 모델 3개 진행 (월 단위 데이터)
* 전국 
  - ~~전국 데이터로 학습시킨 모델~~
  - 행정구역별 데이터로 학습시킨 모델

* 세종시와 서울시 출산율 비교 
  - 서울시 데이터로 학습시킨 모델
  - 세종시 데이터로 학습시킨 모델

### 1) 학습, 예측, 성능 평가

- 제우
    - ridge, lasso,elasticnet (규제가 있는 선형회귀)

- 도희
    - catboost (앙상블), decesionregressor, randomforestregressor (트리), 다중선형회귀, KNN

- 기훈
    - xgboostregressor, lightboost, gradientboost (앙상블 부스팅) 

* 학습용, 테스트용 분리
    x_train, y_train : 2006 ~ 2021 월별 샘플
    x_test, y_test : 2022 월별

    2022 없는 데이터 중 찾은 것
    * 이혼율 中 이혼건수, 혼인건수 (2021 월별 데이터와 맞는지 확인 완료) | 2022.01 - 2022.11까지

    * 출산율 中 총 출생아수 | 2022.01 - 2022.11까지
       - 연령별 여성인구 2008 ~ 2023
       - 총 출생아수 1997 ~ 2021
       => 업데이트 완료 --> 파일명 1997-2022로 변경 => 출산율 모델에 업데이트 필요

    * 지가변동율 : 2022.01 - 2022.11까지 구해야 함

### 2) 독립변수가 여러 개일 때, 모델의 성능을 시각화하려면 실제값과 예측값의 분포차이를 그린다
### 3) 최적의 모델 확인